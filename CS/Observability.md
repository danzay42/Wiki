**Monitoring** is *reactive*, and **observability** is *proactive*
Если **мониторинг** — это действие, то **observability**  — это свойство системы

| monitoring                                   | observability                                                           |
| -------------------------------------------- | ----------------------------------------------------------------------- |
| Сломалось или нет?                           | Почему сломалось?                                                       |
| Реагируем быстро, но после инцидента         | Предотвращаем инциденты,<br>сокращаемих продолжительность и последствия |
| Сервис работает?                             | Насколько эффективно работает сервис?                                   |
| Разрозненные данные                          | Тесно связанные данные                                                  |
| Пассивно потребляем данные и метрики системы | Активно изучаем свою среду                                              |


# Logging

Системы логирования занимаются сбором логов с разных источников (приложения, системные логи) на разных устройствах в одно место.

## Уровни логирования в приложениях
- info
- error?
- fatal


# Tracing
Трассировка — это метод, который используют для профилирования и мониторинга приложений.

Трассировки оперируют понятиями **span** и **trace**

## Span
- название сервиса
- уникальный ID
- ID родительского span
- название вызываемого метода
- время начала и окончания

![[tracing-data-model.png]]

Трассировка - это набор/список span, которые соединены отношением родитель/потомок (его также можно рассматривать как направленный ациклический граф отрезков)


# Metrics

## Подходы
- White Box
	Наблюдение показателей, доступных внутри системы
- Black Box
	Наблюдение поведения со стороны пользователя

## Базовые наборы метрик

4 golden signals | RED | USE
--- | --- | ---
Latency | **R**ate | **U**tilization
Traffic | **E**rrors | **S**aturation
Errors | **D**uration | **E**rrors
Saturation |


# Используемые технологии

**Логирование**
- Fluentd

**Трейсинг**
- Jaeger
- OpenTelemetry

**Метрики**
- Prometheus
- Sentry

**Дашборды**
- Grafana

## Prometheus

[#PromQL](https://prometheus.io/docs/prometheus/latest/querying/basics/)
Структура метрики: `myMetric{...myLabels}`
`myLabels` - список пар `key="value"`
> желательно иметь наименьшее количество уникальных метрик

### Типы метрик
- **Counter**
	*Счетчик* можно увеличивать или сбросить в 0
- **Gauge**
	*Измеритель* можно увеличивать или уменьшать
- **Histogram**
	*Гистограмма*: несколько временных рядов - совокупные счетчики для бакетов, сумма наблюдаемых значений и общий счетчик событий
- **Summary**
	*Сводка* похожа на гистограмму (показывает сумму наблюдаемых значений и счетчик для событий), но также предоставляет расчет для **φ-квантилей**

## Grafana
[#LogQL](https://grafana.com/docs/loki/latest/logql/)